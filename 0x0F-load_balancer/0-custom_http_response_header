#!/usr/bin/env bash
# Configures Nginx to send a custom HTTP header with the server's hostname

# Install Nginx if not installed
sudo apt-get update && sudo apt-get install -y nginx

# Start and enable Nginx to ensure it runs on boot
sudo systemctl start nginx
sudo systemctl enable nginx

# Determine the hostname of the server
HOSTNAME=$(hostname)

# Configure Nginx to add the X-Served-By custom header
# Create a backup of the original config file
sudo cp /etc/nginx/sites-available/default /etc/nginx/sites-available/default.bak

# Add the custom header configuration
echo "Adding custom header to Nginx configuration."
sudo sed -i "/server_name _;/a add_header X-Served-By $HOSTNAME;" /etc/nginx/sites-available/default

# Restart Nginx to apply changes
sudo systemctl restart nginx

echo "Nginx is configured with a custom HTTP header."
